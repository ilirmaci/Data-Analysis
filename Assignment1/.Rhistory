setwd("/data/Dropbox/Data Analysis/Week4/")
names(samsungData)
numericActivity <- as.numeric(as.factor(samsungData$activity))[samsungData$subject==1]
dim(samsungData)
object.size(samsungData)
object.size(samsungData)/1000000
require(ggplot2)
require(data.table)
s <- data.table(samsungData)
rm(samsungData)
tables()
setkey(s, subject)
class(s$activity)
class(s$subject)
table(s$subject)
names(s)[1:2]
p1 <- ggplot(s[1,], aes_string(x=1:length(s[1,]), y="tBodyAcc-mean()-X", color=activity))
p1 <- ggplot(s[1,], aes_string(x=1:length(s[1,]), y="tBodyAcc-mean()-X", color="activity"))
d12 <- melt(s[1:2, 1:2])
require(reshape2)
d12 <- melt(s[1:2, 1:2])
names(d12)
d12 <- melt(s[1, c(1, 2, 563)], id.vars="activity")
head(d12)
d12 <- melt(s[1, c(1, 2, 563), with=FALSE], id.vars="activity")
head(d12)
table(s[1, activity])
tables()
table(s[activity])
table(s[,activity])
table(s[,subject])
table(s[1, activity])
table(s["1", activity])
table(s[2, activity])
head(s[2,])
table(s[2,]$activity)
head(s[2,]$activity)
dim(s[2,])
s$subject <- as.character(s$subject)
setkey(s, subject)
load("samsungData.rda")
s <- data.table(samsungData)
s$subject <- as.character(s$subject)
setkey(s, subject)
rm(samsungData)
d12 <- melt(s["1", c(1, 2, 563), with=FALSE], id.vars="activity")
dim(s["2",])
dim(s["1",])
dim(s["2",])
dim(s["3",])
table(s$subject)
d12 <- melt(s["1", c(1, 2, 563), with=FALSE], id.vars="activity")
dim(d12)
table(s["3",activity])
table(s["2",activity])
table(s["1",activity])
s["1",activity]
table(s["1",activity][2])
table(s["1",activity][,2])
s["1",activity]
ssss <- s["1", acticity]
ssss <- s["1", activity]
dim(ssss)
str(ssss)
table(s["1",activity]$activity)
nrow(d12)
nrow(d12)/2
xvals <- 1:nrow(d12)//2
5//2
5 %/% 2
xvals <- 1:nrow(d12) %/% 2
tail(xvals)
p1 <- ggplot(d12, aes(x=xvals, y=value , color=activity))
p1 + facet_wrap(~variable)
p1 + geom_point(size=3) + facet_wrap(~variable)
d12
p1 <- ggplot(d12, aes(x=seq_along(value), y=value , color=activity))
p1 + geom_point(size=3) + facet_wrap(~variable)
p1 <- ggplot(d12, aes(y=value , color=activity))
p1 + geom_point(size=3) + facet_wrap(~variable)
p1 <- ggplot(d12, aes(x=value , color=activity))
p1 + geom_dotplot(size=3) + facet_wrap(~variable)
p1 <- ggplot(d12, aes(x=seq_along(value), y=value, color=activity))
p1 + geom_point(size=3) + facet_wrap(~variable)
distanceMatrix <- dist(s$subject["1"])
distanceMatrix <- dist(s["1", 1:3, with=FALSE])
distanceMatrix
class(distanceMatrix)
dim(distanceMatrix)
str(distanceMatrix)
head(s["1", 1:3, with=F])
hc <- hclust(distanceMatrix)
plot(hc)
plot(hc)
svd1 <- svd(scale(s[1, 1:561, with=FALSE]))
svd1 <- svd(scale(s["1", 1:561, with=FALSE]))
str(svd1)
svd1.flat <- melt(svd1)
head(svd1.flat)
svd1.flat <- melt(svd1$u)
head(svd1.flat)
svd1.flat <- melt(svd1$u[,1:2])
head(svd1.flat)
names(svd1.flat) <- c("r", "c", "value")
x <- s["1", activity]
head(x)
x <- s["1", activity][,2, with=F]
head(x)
?data.table
p2 <- ggplot(svd1.flat, aes(x=r, y=value, color=x))
p2 <- geom_point(size=3) + facet_wrap(~c)
names(svd1.flat) <- c("r", "c", "value")
x <- s["1", activity][,2, with=F]  ## activity names
p2 <- ggplot(svd1.flat, aes(x=r, y=value, color=x))
p2 + geom_point(size=3) + facet_wrap(~c)
p2 <- ggplot(svd1.flat, aes(x=r, y=value, color=rep(x,2)))
p2 + geom_point(size=3) + facet_wrap(~c)
p2 <- ggplot(svd1.flat, aes(x=r, y=value))
p2 + geom_point(size=3) + facet_wrap(~c)
dim(svd1.flat)
dim(x)
dim(rep(x ,2))
x
x <- as.character(s["1", activity])
x
head(s["1", list(activity)])
head(s["1", activity])
head(s["1", "activity", with=F])
x <- s["1", "activity", with=F]
x
x <- c(s["1", "activity", with=F])
x
x <- rep(s["1", "activity", with=F], 2)
x
x
x <- s["1", "activity", with=F]
x
x <- rep(c(s["1", "activity", with=F]), 2)
p2 <- ggplot(svd1.flat, aes(x=r, y=value, color=x))
p2 + geom_point(size=3) + facet_wrap(~c)
x
x <- c(s["1", "activity", with=F]
)
x
x <- as.vector(s["1", "activity", with=F])
x
x <- s["1",]$activity
x
x <- rep(s["1",]$activity, 2)
p2 <- ggplot(svd1.flat, aes(x=r, y=value, color=x))
p2 + geom_point(size=3) + facet_wrap(~c)
head(d12)
xvals <- 1:nrow(d12)%/%2
p1 <- ggplot(d12, aes(x=xvals, y=value, color=activity))
p1 + geom_point(size=3) + facet_wrap(~variable)
xvals <- rep(1:nrow(d12)%/%2, 2)
p1 <- ggplot(d12, aes(x=xvals, y=value, color=activity))
p1 + geom_point(size=3) + facet_wrap(~variable)
xvals <- rep(1:nrow(d12)%/%4, 2)
p1 <- ggplot(d12, aes(x=xvals, y=value, color=activity))
p1 + geom_point(size=3) + facet_wrap(~variable)
key(d12)
tapply(d12$activity, d12$variable, nrow)
tapply(d12$activity, d12$variable, length)
p1 <- ggplot(d12, aes(x=1:347, y=value, color=activity))
p1 + geom_point(size=3) + facet_wrap(~variable)
xvals <- rep(1:347, 2)
p1 <- ggplot(d12, aes(x=1:347, y=value, color=activity))
p1 + geom_point(size=3) + facet_wrap(~variable)
p1 <- ggplot(d12, aes(x=xvals, y=value, color=activity))
p1 + geom_point(size=3) + facet_wrap(~variable)
nrow(d12) %/% 2
1:nrow(d12) %/% 2
xvals <- rep(1:nrow(d12)%/%2, 2)
p1 <- ggplot(d12, aes(x=xvals, y=value, color=activity))
p1 + geom_point(size=3) + facet_wrap(~variable)
xvals <- rep(1:nrow(d12) %/% 2, 2)
xvals
xvals <- rep(1:(nrow(d12) %/% 2), 2)
xvals
xvals <- rep(1:(nrow(d12) %/% 2), 2)
p1 <- ggplot(d12, aes(x=xvals, y=value, color=activity))
p1 + geom_point(size=3) + facet_wrap(~variable)
?relevel
rm(list=ls())
setwd("/data/Dropbox/Data Analysis/Assignment1/")
# Load the dataset
cc <- rep("character", 15) ## colClasses vector
cc[c(2, 3, 10)] <- "numeric"
cc[12:14] <- "integer"
cc[c(5, 6, 8, 9, 11, 15)] <- "factor"
ld <- read.csv("loansData.csv", colClasses=cc, row.names=1)
### Retouching formats
# changing Interest.Rate to numeric
ld$Interest.Rate <- gsub("%", "", x=ld$Interest.Rate, fixed=TRUE)
ld$Interest.Rate <- as.numeric(ld$Interest.Rate)
# changing Debt.To.Income.Ratio to numeric
ld$Debt.To.Income.Ratio <- gsub("%", "", x=ld$Debt.To.Income.Ratio, fixed=TRUE)
ld$Debt.To.Income.Ratio <- as.numeric(ld$Debt.To.Income.Ratio)/100
# reordering Home.Ownership levels
ll <- c("NONE", "RENT", "MORTGAGE", "OWN", "OTHER")
ld$Home.Ownership <- factor(ld$Home.Ownership, levels=ll)
# correcting order of Employment.Length factor
ll <- c("< 1 year", "1 year", "2 years", "3 years", "4 years", "5 years",
"6 years", "7 years", "8 years", "9 years", "10+ years", "n/a")
ld$Employment.Length <- factor(ld$Employment.Length, levels=ll)
names(ld)
m1 <- lm(Interest.Rate ~ Amount.Requested + Loan.Length + Loan.Purpose+ Debt.To.Income.Ratio + Home.Ownership + FICO.Range)
m1 <- lm(Interest.Rate ~ Amount.Requested + Loan.Length + Loan.Purpose+ Debt.To.Income.Ratio + Home.Ownership + FICO.Range, data=ld)
summary(m1)
table(ld$Loan.Length)
table(ld$Loan.Length)
summary(m1)
m1 <- lm(Interest.Rate ~ Amount.Requested + Loan.Length + Debt.To.Income.Ratio + Home.Ownership + FICO.Range, data=ld)
summary(m1)
m1 <- lm(Interest.Rate ~ Amount.Requested + Loan.Length + Debt.To.Income.Ratio + FICO.Range, data=ld)
names(ld)
m1 <- lm(Interest.Rate ~ Amount.Requested + Loan.Length + Debt.To.Income.Ratio + FICO.Range, data=ld)
summary(m1)
names(ld)
m1 <- lm(Interest.Rate ~ FICO.Range + Amount.Requested + Loan.Length + Open.CREDIT.Lines + Revolving.CREDIT.Balance + Inquiries.in.the.Last.6.Months + Employment.Length, data=ld)
names(ld)
summary(m1)
ggplot(ld, aes(x=Revolving.CREDIT.Balance, y=Interest.Rate, color=Loan.Length)) + geom_point(size=3)
ggplot(ld, aes(x=log(Revolving.CREDIT.Balance), y=Interest.Rate, color=Loan.Length)) + geom_point(size=3)
ggplot(ld, aes(x=log(Revolving.CREDIT.Balance+1), y=Interest.Rate, color=Loan.Length)) + geom_point(size=3)
hist(ld$Revolving.CREDIT.Balance)
hist(log(ld$Revolving.CREDIT.Balance+1))
hist(log10(ld$Revolving.CREDIT.Balance+1))
m1 <- lm(Interest.Rate ~ FICO.Range + Employment.Length, data=ld)
summary(m1)
m1 <- lm(Interest.Rate ~ FICO.Range + Amount.Requested + Loan.Length
+ Open.CREDIT.Lines + Inquiries.in.the.Last.6.Months, data=ld)
summary(m1)
p1 <- ggplot(ld, aes(x=FICO.Range, y=Interest.Rate)) + geom_boxplot()
p1
?geom_boxplot
p1 <- ggplot(ld, aes(x=FICO.Range, y=Interest.Rate)) + geom_boxplot(aes(size=..bin..))
p1
### Regression analysis
p1 <- ggplot(ld, aes(x=FICO.Range, y=Interest.Rate)) + geom_boxplot(aes(size=..count..))
p1
p1 <- ggplot(ld, aes(x=FICO.Range, y=Interest.Rate)) + geom_boxplot(aes(width=..count..))
p1
p1 <- ggplot(ld, aes(x=FICO.Range, y=Interest.Rate)) + geom_boxplot()
ggplot(ld, aes(x=FICO.Range, y=Interest.Rate)) + geom_boxplot()
m1 <- lm(Interest.Rate ~ FICO.Range + Amount.Requested + Loan.Length
+ Open.CREDIT.Lines + Inquiries.in.the.Last.6.Months, data=ld)
summary(m1)
names(ld)
m2 <- lm(Interest.Rate ~ FICO.Range + I(Amount.Requested - Amount.Funded.by.Investors) + Loan.Length
+ Open.CREDIT.Lines + Inquiries.in.the.Last.6.Months, data=ld)
m2 <- lm(Interest.Rate ~ FICO.Range + I(Amount.Requested - Amount.Funded.By.Investors) + Loan.Length
+ Open.CREDIT.Lines + Inquiries.in.the.Last.6.Months, data=ld)
summary(m2)
names(ld)
ggplot(ld, aes(x=Amount.Funded.By.Investors, y=Amount.Requested)) + geom_point()
ggplot(ld, aes(x=Amount.Funded.By.Investors, y=Amount.Requested, color=Employment.Length)) + geom_point()
ggplot(ld, aes(x=Amount.Funded.By.Investors, y=Amount.Requested)) + geom_point() + facet_wrap(~Employment.Length)
m2 <- lm(Interest.Rate ~ FICO.Range + I(Amount.Requested-Amount.Funded.By.Investors)
+ Loan.Purpose + Debt.To.Income.Ratio + State + Home.Ownership + Monthly.Income, data=ld)
summary(m2)
names(ld)
m2 <- lm(Interest.Rate ~ FICO.Range + Loan.Purpose + Debt.To.Income.Ratio + State
+ Home.Ownership + Monthly.Income + Employment.Length, data=ld)
summary(m2)
levels(ld$State)
